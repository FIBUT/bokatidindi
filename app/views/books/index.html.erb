<main role="main" aria-label="Bækur">

  <% unless params[:publisher] || params[:category] || params[:author] %>
  <h1>Allar bækur</h1>
  <% else %>
  <h1>Niðurstöður leitar</h1>
  <ul>
    <% unless params[:author].nil? %>
    <li>
      <strong>Höfundur</strong>
      <%= Author.find_by(slug: params[:author]).name %>
    </li>
    <% end %>
    <% unless params[:publisher].nil? %>
    <li>
      <strong>Útgefandi</strong>
      <%= Publisher.find_by(slug: params[:publisher]).name %>
    </li>
    <% end %>
    <% unless params[:category].nil? %>
    <li>
      <strong>Vöruflokkur</strong>
      <%= Category.find_by(slug: params[:category]).name %>
    </li>
    <% end %>
  </ul>
  <% end %>

  <p id="notice"><%= notice %></p>

  <% @books.each do |book| %>
  <section
    id="book-<%= book.id %>"
    class="book row"
    aria-labelledby="book-<%= book.id %>-hgroup"
  >

    <%= render 'books/figure', mock_image: book.mock_image %>

    <div class="col py-5">

      <a href="<%= book_path(book.slug) %>">
        <%= render 'books/hgroup', book_id: book.id, pre_title: book.pre_title, title: book.title, post_title: book.post_title %>
      </a>

      <%= render 'books/authors', book_id: book.id, author_groups: book.author_groups %>

      <% unless book.description.empty? %>

      <p
        aria-label="Lýsing"
        class="book-description overflow-hidden"
      >
        <%= book.short_description %>
      </p>

      <% end %>

      <ul
        id="book-meta-list-<%= book.id %>"
        class="book-meta-list"
        aria-label="Upplýsingar um bók"
      >
        <li
          class="book-meta-publisher"
          aria-labelledby="book-meta-publisher-label-<%= book.id %>"
        >
          <strong
            id="book-meta-publisher-label-<%= book.id %>"
            class="book-meta-publisher-label"
          >
            Útgefandi
          </strong>
          <%=
            link_to book.publisher.name,
            "/baekur/?publisher=#{book.publisher.slug}",
            title: "Skoða fleiri bækur frá útgefandanum #{book.publisher.name}"
          %>
        </li>
        <li
          class="book-meta-category"
          aria-labelledby="book-meta-category-label<%= book.id %>"
        >
          <strong
            id="book-meta-category-label<%= book.id %>"
            class="book-meta-category-label"
          >
            <%= book.categories_label %>
          </strong>
          <%= raw book.category_links %>
        </li>
        <li
          class="book-meta-page-count"
          aria-labelledby="book-meta-page-count-label<%= book.id %>"
        >
          <strong
            id="book-meta-page-count-label<%= book.id %>"
            class="book-meta-page-count-label"
          >
            Blaðsíðutal
          </strong>
          <%= book.page_count %>
        </li>
        <% unless book.hours.nil? %>
        <li
          class="book-meta-hours"
          aria-labelledby="book-meta-hours-label<%= book.id %>"
        >
          <strong
            id="book-meta-hours-label<%= book.id %>"
            class="book-meta-hours-label"
          >
            Upplestrartími
          </strong>
          <%= book.hours %>
          <abbr title="klukkustundir">klst.</abbr>
        </li>
        <% end %>

      </ul>

      <ul
        id="book-binding-list-<%= book.id %>"
        class="book-binding-list"
        aria-label="Bókin er til sem"
      >
        <% book.book_binding_types.each do |b| %>
          <li class="binding--<%= b.binding_type.slug %>">
            <%= b.binding_type.name %>
          </li>
        <% end %>
      </ul>

      <%= link_to 'Meira', book_path(book.slug), class: "btn btn-primary" %>

    </div>
  </section>

  <% end %>

  <%= paginate @books %>

</main>